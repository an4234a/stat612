---
title: "project"
author: "Alan- Kevin"
date: "11/1/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```


```{r}
##load df
crime <- read_csv(file = "Arrests 2017 Public.csv")
head(crime)
```

# 1. There is a association between defendant profile (age, race, ethnicity and/or sex, state address) and type of arrest category. 

- There was more offense by male than by female; most defendant age is between 20-30 (graph a)
- There was more offense by Black than white and Asian. (graph b)
- Between White, there was not much difference for hispanic and non hispanic (Graph c)
- Simple Assault, Release Violations/Fugitive and Traffic Violations were the most occuring offense, either for male and female (table i and table ii)
## Graph a
```{r}
crime %>%
  filter(`Defendant Sex` != "UNK") %>%
  ggplot(aes(Age)) +
  geom_histogram() + 
  theme_bw() + 
  facet_wrap(~`Defendant Sex`) +
  xlab("Defendant Age") + ylab("number of arrest") + ggtitle("number of arrest by age and gender in 2017") 
```

## Graph b
```{r}
crime %>%
  filter(`Defendant Race` != "UNK") %>%
  ggplot(aes(Age)) +
  geom_histogram() + 
  theme_bw() + 
  facet_wrap(~`Defendant Race`) +
  xlab("Defendance age") + ylab("number of arrest") + ggtitle("number of arrest by age and Race in 2017") 
```
## Graph c
```{r}
crime %>%
  filter(`Defendant Race` == "WHITE") %>%
  ggplot(aes(Age)) +
  geom_histogram() + 
  theme_bw() + 
  facet_wrap(~`Defendant Ethnicity`) +
  xlab("Defendant Age") + ylab("number of arrest") + ggtitle("number of arrest by White ethnicity in 2017") 
```

##table i and table ii
```{r}
crime_by_sex <- crime %>%
  filter(`Defendant Sex` != "UNK") %>%
  group_by(`Arrest Category`,`Defendant Sex`) %>%
  tally () %>%
  ungroup() %>%
  spread(key = `Defendant Sex`, value = n)


##table i - top 3 female offense
crime_by_sex %>%
  select(1,2) %>%
  arrange(desc(FEMALE)) %>%
  slice(1:3)

##table ii - top 3 male offense
crime_by_sex %>%
  filter( `Arrest Category` != "Other Crimes") %>%
  select(1,3) %>%
  arrange(desc(MALE)) %>%
  slice(1:3)
```
